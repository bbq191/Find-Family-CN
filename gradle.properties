# ======================================
# Gradle 配置
# ======================================

# JVM 参数配置（已优化用于 64GB 内存）
# -Xmx12288M: 最大堆内存 12GB（64GB 内存可以分配更多）
# -Xms2048M: 初始堆内存 2GB（减少垃圾回收频率）
# -XX:MaxMetaspaceSize=1024M: Metaspace 最大 1GB
# -XX:+HeapDumpOnOutOfMemoryError: 内存溢出时生成堆转储
# -XX:+UseG1GC: 使用 G1 垃圾回收器（更适合大堆内存）
# -Dfile.encoding=UTF-8: 强制使用 UTF-8 编码
# -Dkotlin.daemon.jvm.options: Kotlin 编译守护进程内存 6GB
# -Dhttps.protocols=TLSv1.2,TLSv1.3: 指定支持的 TLS 协议版本
# -Djdk.tls.client.protocols=TLSv1.2,TLSv1.3: JDK TLS 客户端协议
org.gradle.jvmargs=-Xmx12288M -Xms2048M -XX:MaxMetaspaceSize=1024M -XX:+HeapDumpOnOutOfMemoryError -XX:+UseG1GC -Dfile.encoding=UTF-8 -Dkotlin.daemon.jvm.options\="-Xmx6144M" -Dhttps.protocols=TLSv1.2,TLSv1.3 -Djdk.tls.client.protocols=TLSv1.2,TLSv1.3

# 启用构建缓存（提升重复构建速度）
org.gradle.caching=true

# 启用配置缓存（实验性功能，大幅提升构建速度）
# 暂时禁用配置缓存以解决 TLS 问题
org.gradle.configuration-cache=false

# 并行构建（充分利用多核 CPU）
org.gradle.parallel=true

# 增加 Gradle 守护进程空闲超时（减少重启频率）
org.gradle.daemon.idletimeout=7200000

# 启用文件系统监控（增量构建优化）
org.gradle.vfs.watch=true

# 并行编译的最大 worker 数量（建议为 CPU 核心数）
# 如果 CPU 核心数较多（如 16 核），可以设置为核心数的 75%
org.gradle.workers.max=12

# ======================================
# Kotlin 配置
# ======================================

# Kotlin 代码风格：使用官方风格指南
kotlin.code.style=official

# 允许在 CocoaPods 依赖中使用已废弃的 embed 和 sign
kotlin.apple.deprecated.allowUsingEmbedAndSignWithCocoaPodsDependencies=true

# Kotlin Native 缓存类型（none 可避免某些构建问题）
kotlin.native.cacheKind=none

# 启用增量编译（加速 Kotlin 编译）
kotlin.incremental=true

# ======================================
# Android 配置
# ======================================

# 使用 AndroidX 库
android.useAndroidX=true

# 非传递性 R 类（减小 APK 大小，提升构建速度）
android.nonTransitiveRClass=true

# ======================================
# 网络和 TLS 配置（系统属性）
# ======================================
# 以系统属性形式配置 TLS 协议（更可靠）
systemProp.https.protocols=TLSv1.2,TLSv1.3
systemProp.jdk.tls.client.protocols=TLSv1.2,TLSv1.3
